(()=>{var y=(a,e,r,t,v)=>function(o){for(var n=0,d=0,u=0;n<a&&d<t;n+1===a?(n=0,d++,u+=a):n++)o({cells:this,currentIndex:n+u,i:n,j:d,widthNum:a,canvasWidth:r,heightNum:t,rowOffset:u,cellWidth:e,cellHeight:v})};function E(a=0,e=this.length-1){for(var r=[];e-->=a;){let t=Math.floor(Math.random()*(e+1));[this[e],this[t]]=[this[t],this[e]],r.push(this[e])}return r}Array.prototype.shuffle=E;var k="#ebebe1";document.body.style.backgroundColor=k;var g=document.getElementById("ca"),s=g.getContext("2d",{willReadFrequently:!0}),L=document.getElementById("resolution"),h=0,T=()=>window.innerWidth<window.innerHeight?window.innerWidth*h:window.innerHeight*h,p=0,b=null,I=!1,B=(a,e,r)=>{p=Number(r);var t=p,v=p,l=a/t,o=e/v,n=I===!1?1:p/a;return{widthNum:t,cellWidth:l,heightNum:v,cellHeight:o,sideDivider:n}},i={empty:0,alive:16,dead:15,aliveNext:8,deadNext:23,n:7,dropN:24},N=(a,e,r)=>{var t=e*(r*4)+a*4;return[t,t+1,t+2,t+3]},W=(a,e,r,t,v,l)=>{var o=0,n=0,d=new Uint8Array(Array.from({length:e*t},()=>(o+1===e?(o=0,n++):o++,a[N(Math.floor(o/l),Math.floor(n/l),r)[0]]<129?i.alive:i.empty)));return d},S=({cells:a,currentIndex:e,i:r,j:t,widthNum:v,heightNum:l})=>{var o=a[e],n=0;r-1>0&&a[e-1]&i.alive&&n++,r+1<v&&a[e+1]&i.alive&&n++,t-1>0&&a[e-v]&i.alive&&n++,t+1<l&&a[e+v]&i.alive&&n++,a[e]=(n===1||n===3?o|i.aliveNext:o&i.deadNext)|n},U=["#f0ba00","#de8790","#6b1f1c","#333c7d","#367148","#91b9d6","#aa2404"],q=U.shuffle(0,5);var z=({currentIndex:a,cells:e,cellWidth:r,cellHeight:t,canvasWidth:v,i:l,j:o})=>{var n=e[a];n&i.alive&&(s.fillStyle=q[n&i.n],s.fillRect(l*r,o*t,r,t)),e[a]=n&i.aliveNext?(n|i.alive)&i.dropN:i.empty},G=(a,e,r)=>{g.width=a,g.height=e,g.style.width=a/r+"px",g.style.height=e/r+"px"},w=Date.now(),P=4,_=1e3/P,f=0,C=(a,e,r)=>{var t=Date.now();t-w>=_&&(a.wrappedForEach(S),s.clearRect(0,0,e,r),a.wrappedForEach(z),w=t),f=requestAnimationFrame(C.bind(null,a,e,r))},F=a=>{f>0&&cancelAnimationFrame(f);var e=T(),r=e,{widthNum:t,cellWidth:v,heightNum:l,cellHeight:o,sideDivider:n}=B(e,r,L.value);G(e,r,h),s.drawImage(a,0,0,e,r);var d=s.getImageData(0,0,e,r).data;s.clearRect(0,0,e,r),s.fillStyle="#f00";var u=y(t,v,e,l,o,n),H=W(d,t,e,l,r,n);Uint8Array.prototype.wrappedForEach=u,C(H,e,r)},A=a=>{var e=new Image;e.src=a,b=e,e.addEventListener("load",M.bind(null,e),{once:!0})},M=a=>{I=!0,F(a)};L.addEventListener("change",()=>{M(b)});window.addEventListener("resize",()=>{F(b)});var c=document.getElementById("controls");c.addEventListener("dragover",()=>{c.classList.add("dragover")});c.addEventListener("dragleave",()=>{c.classList.remove("dragover")});var R=document.getElementById("userimageform"),x=()=>{var a=new FormData(R),e=a.get("userimage");return!e||e.name===""?null:e},D=a=>{let e=new FileReader;e.readAsDataURL(a),e.onload=r=>{A(r.target.result)}};R.addEventListener("submit",()=>{var a=x();a&&D(a),c.classList.remove("dragover")});var j=()=>{h=Math.min(window.devicePixelRatio,2);var a=x();a?D(a):A("./img3.jpg")};j();var m=document.getElementById("userimage");m.addEventListener("dragover",()=>{m.classList.add("dragover")});m.addEventListener("dragleave",()=>{m.classList.remove("dragover")});m.addEventListener("drop",()=>{m.classList.remove("dragover")});})();
//# sourceMappingURL=script-dist.js.map
