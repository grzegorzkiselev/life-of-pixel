(()=>{var L=(a,e,r,n,l)=>function(v){for(var t=0,d=0,g=0;t<a&&d<n;t+1===a?(t=0,d++,g+=a):t++)v({cells:this,currentIndex:t+g,i:t,j:d,widthNum:a,canvasWidth:r,heightNum:n,rowOffset:g,cellWidth:e,cellHeight:l})};function I(a=0,e=this.length-1){for(var r=[];e-->=a;){let n=Math.floor(Math.random()*(e+1));[this[e],this[n]]=[this[n],this[e]],r.push(this[e])}return r}Array.prototype.shuffle=I;var B="#ebebe1";document.body.style.backgroundColor=B;var c=document.getElementById("ca"),u=c.getContext("2d",{willReadFrequently:!0}),F=document.getElementById("resolution"),E=0,N=()=>window.innerWidth<window.innerHeight?window.innerWidth*E:window.innerHeight*E,w=0,f=null,C=!1,S=(a,e,r)=>{w=Number(r);var n=w,l=w,i=a/n,v=e/l,t=C===!1?1:w/a;return{widthNum:n,cellWidth:i,heightNum:l,cellHeight:v,sideDivider:t}},o={empty:0,alive:16,dead:15,aliveNext:8,deadNext:23,n:7,dropN:24},M=(a,e,r)=>{var n=e*(r*4)+a*4;return[n,n+1,n+2,n+3]},q=(a,e,r,n,l,i)=>{var v=0,t=0,d=new Uint8Array(Array.from({length:e*n},()=>(v+1===e?(v=0,t++):v++,a[M(Math.floor(v/i),Math.floor(t/i),r)[0]]<129?o.alive:o.empty)));return d},z=({cells:a,currentIndex:e,i:r,j:n,widthNum:l,heightNum:i})=>{var v=a[e],t=0;r-1>0&&a[e-1]&o.alive&&t++,r+1<l&&a[e+1]&o.alive&&t++,n-1>0&&a[e-l]&o.alive&&t++,n+1<i&&a[e+l]&o.alive&&t++,a[e]=(t===1||t===3?v|o.aliveNext:v&o.deadNext)|t},G=[new Uint8Array([255,0,0,255]),new Uint8Array([0,255,0,255]),new Uint8Array([0,0,255,255]),new Uint8Array([255,255,0,255]),new Uint8Array([0,255,255,255]),new Uint8Array([255,0,255,255])],P=G.shuffle(0,5),s,_=({currentIndex:a,cells:e,cellWidth:r,cellHeight:n,canvasWidth:l,i,j:v})=>{for(var t=e[a],d=0;d<r;d++)for(var g=0;g<r;g++){var m=M(Math.floor(i*r)+d,Math.floor(v*r)+g,l);if(t&o.alive){var h=P[t&o.n];s[m[0]]=h[0],s[m[1]]=h[1],s[m[2]]=h[2],s[m[3]]=h[3]}else s[m[0]]=0,s[m[1]]=0,s[m[2]]=0,s[m[3]]=0}e[a]=t&o.aliveNext?(t|o.alive)&o.dropN:o.empty},j=(a,e,r)=>{c.width=a,c.height=e,c.style.width=a/r+"px",c.style.height=e/r+"px"},A=Date.now(),J=4,K=1e3/J,b=0,U=(a,e,r)=>{var n=Date.now();n-A>=K&&(a.wrappedForEach(z),u.clearRect(0,0,e,r),a.wrappedForEach(_),u.putImageData(new ImageData(new Uint8ClampedArray(s),e,e),0,0),A=n),b=requestAnimationFrame(U.bind(null,a,e,r))},D=a=>{b>0&&cancelAnimationFrame(b);var e=N(),r=e,{widthNum:n,cellWidth:l,heightNum:i,cellHeight:v,sideDivider:t}=S(e,r,F.value);j(e,r,E),u.drawImage(a,0,0,e,r);var d=u.getImageData(0,0,e,r).data;u.clearRect(0,0,e,r),u.fillStyle="#f00";var g=L(n,l,e,i,v,t),m=q(d,n,e,i,r,t);s=new Uint8ClampedArray(e*e*4),Uint8Array.prototype.wrappedForEach=g,U(m,e,r)},R=a=>{var e=new Image;e.src=a,f=e,e.addEventListener("load",x.bind(null,e),{once:!0})},x=a=>{C=!0,D(a)};F.addEventListener("change",()=>{x(f)});window.addEventListener("resize",()=>{D(f)});var y=document.getElementById("controls");y.addEventListener("dragover",()=>{y.classList.add("dragover")});y.addEventListener("dragleave",()=>{y.classList.remove("dragover")});var H=document.getElementById("userimageform"),k=()=>{var a=new FormData(H),e=a.get("userimage");return!e||e.name===""?null:e},T=a=>{let e=new FileReader;e.readAsDataURL(a),e.onload=r=>{R(r.target.result)}};H.addEventListener("submit",()=>{var a=k();a&&T(a),y.classList.remove("dragover")});var Q=()=>{E=Math.min(window.devicePixelRatio,2);var a=k();a?T(a):R("./img3.jpg")};Q();var p=document.getElementById("userimage");p.addEventListener("dragover",()=>{p.classList.add("dragover")});p.addEventListener("dragleave",()=>{p.classList.remove("dragover")});p.addEventListener("drop",()=>{p.classList.remove("dragover")});})();
//# sourceMappingURL=script-dist.js.map
