(()=>{var h=(e,r,a,t)=>function(i){for(var n=0,v=0,s=0;n<e&&v<a;n+1===e?(n=0,v++,s+=e):n++)i({cells:this,currentIndex:n+s,i:n,j:v,widthNum:e,heightNum:a,cellWidth:r,cellHeight:t})},b=(e,r=0,a=e.length-1)=>{for(var t=[];a-->=r;){let o=Math.floor(Math.random()*(a+1));[e[a],e[o]]=[e[o],e[a]],t.push(e[a])}return t};var T="#ebebe1",k="./img3.jpg";document.body.style.backgroundColor=T;var u=document.getElementById("ca"),l=u.getContext("2d",{willReadFrequently:!0}),p=0,c=0,B=b(["#f0ba00","#de8790","#6b1f1c","#333c7d","#367148","#91b9d6","#aa2404"],0,3),d={empty:0,alive:16,dead:15,aliveNext:8,deadNext:23,n:7,dropN:24},w=Date.now(),N=4,U=1e3/N,f=0,g=document.getElementById("controls"),m=document.getElementById("userimage"),L=document.getElementById("userimageform"),y=document.getElementById("resolution"),E=null,I=!1,W=()=>window.innerWidth<window.innerHeight?window.innerWidth*p:window.innerHeight*p,S=(e,r,a)=>{c=Number(a);var t=c,o=c,i=e/t,n=r/o,v=I===!1?1:c/e;return{widthNum:t,cellWidth:i,heightNum:o,cellHeight:n,sideDivider:v}},q=(e,r,a)=>{var t=r*(a*4)+e*4;return[t,t+1,t+2,t+3]},z=(e,r,a,t,o,i)=>{var n=0,v=0,s=new Uint8Array(Array.from({length:r*t},()=>(n+1===r?(n=0,v++):n++,e[q(Math.floor(n/i),Math.floor(v/i),a)[0]]<129?d.alive:d.empty)));return s},G=({cells:e,currentIndex:r,i:a,j:t,widthNum:o,heightNum:i})=>{var n=e[r],v=0;a-1>0&&e[r-1]&d.alive&&v++,a+1<o&&e[r+1]&d.alive&&v++,t-1>0&&e[r-o]&d.alive&&v++,t+1<i&&e[r+o]&d.alive&&v++,e[r]=(v===1||v===3?n|d.aliveNext:n&d.deadNext)|v},P=({currentIndex:e,cells:r,cellWidth:a,cellHeight:t,i:o,j:i})=>{var n=r[e];n&d.alive&&(l.fillStyle=B[(n&d.n)-1],l.fillRect(o*a,i*t,a,t)),r[e]=n&d.aliveNext?(n|d.alive)&d.dropN:d.empty},_=(e,r,a)=>{u.width=e,u.height=r,u.style.width=e/a+"px",u.style.height=r/a+"px"},F=(e,r,a)=>{var t=Date.now();t-w>=U&&(e.wrappedForEach(G),l.clearRect(0,0,r,a),e.wrappedForEach(P),w=t),f=requestAnimationFrame(F.bind(null,e,r,a))},C=e=>{f>0&&cancelAnimationFrame(f);var r=W(),a=r,{widthNum:t,cellWidth:o,heightNum:i,cellHeight:n,sideDivider:v}=S(r,a,y.value);_(r,a,p),l.drawImage(e,0,0,r,a);var s=l.getImageData(0,0,r,a).data;l.clearRect(0,0,r,a),l.fillStyle="#f00";var D=h(t,o,i,n),H=z(s,t,r,i,a,v);Uint8Array.prototype.wrappedForEach=D,F(H,r,a)},A=e=>{var r=new Image;r.src=e,E=r,r.addEventListener("load",M.bind(null,r),{once:!0})},M=e=>{I=!0,C(e)};y.addEventListener("change",()=>{M(E)});window.addEventListener("resize",()=>{C(E)});g.addEventListener("dragover",()=>{g.classList.add("dragover")});g.addEventListener("dragleave",()=>{g.classList.remove("dragover")});var R=()=>{var e=new FormData(L),r=e.get("userimage");return!r||r.name===""?null:r},x=e=>{var r=new FileReader;r.readAsDataURL(e),r.onload=a=>{A(a.target.result)}};L.addEventListener("submit",()=>{var e=R();e&&x(e),g.classList.remove("dragover")});var j=()=>{p=Math.min(window.devicePixelRatio,2);var e=R();e?x(e):A(k)};m.addEventListener("dragover",()=>{m.classList.add("dragover")});m.addEventListener("dragleave",()=>{m.classList.remove("dragover")});m.addEventListener("drop",()=>{m.classList.remove("dragover")});j();})();
//# sourceMappingURL=script.js.map
